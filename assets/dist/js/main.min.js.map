{"version":3,"sources":["main.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","jQuery","document","ready","$","phoneid","dnivar","charmask","numformat","tag","servernum","defaultnum","dnicode","refnum","data","toString","name","url","window","location","href","replace","results","RegExp","exec","decodeURIComponent","getParameterByName","createCookie","nameEQ","encodeURIComponent","ca","cookie","split","charAt","substring","indexOf","readCookie","dni_number_formatted","console","log","JSON","stringify","format_number","each","this","attr","html","postdata","action","dni_id","parent_phone_id","location_id","dni_tag","dni_number","dni_description","dni_status","ajax","csa_ajaxobject","ajax_url","type","dataType","error","jqXHR","textStatus","errorThrown","success","message","challengenum","content","find","value","days","expires","date","Date","setTime","getTime","toGMTString","rawnumber","match","x","nummask"],"mappings":"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","file":"main.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\n/*\n * -------------------\n * Copyright (c) 2019 Matthew Swetnam\n */\njQuery(document).ready(function ($) {\n  // Define variables\n  if ($('.dni-link').length) {\n    var phoneid, dnivar, charmask, numformat, tag, servernum, defaultnum, lastresort, dnicode, reflist, httpref, refnum;\n\n    if ($('.csa-dni').data('phone-id')) {\n      phoneid = $('.csa-dni').data('phone-id');\n    }\n\n    if ($('.csa-dni').data('dni-var')) {\n      dnivar = $('.csa-dni').data('dni-var');\n    }\n\n    if ($('.csa-dni').data('dni-tag')) {\n      tag = $('.csa-dni').data('dni-tag');\n    }\n\n    if ($('.csa-dni').data('character-mask')) {\n      charmask = $('.csa-dni').data('character-mask');\n    }\n\n    if ($('.csa-dni').data('phone-pattern')) {\n      numformat = $('.csa-dni').data('phone-pattern');\n    }\n\n    if ($('.csa-dni').data('dni-number')) {\n      servernum = $('.csa-dni').data('dni-number').toString();\n    }\n\n    if ($('.csa-dni').data('phone-default')) {\n      defaultnum = $('.csa-dni').data('phone-default').toString();\n    }\n\n    if ($('.csa-dni').data('last-resort')) {\n      lastresort = $('.csa-dni').data('last-resort').toString();\n    }\n\n    if ($('.csa-dni').data('referrer-list')) {\n      reflist = $('.csa-dni').data('referrer-list');\n    }\n\n    if ($('.csa-dni').data('referrer')) {\n      httpref = $('.csa-dni').data('referrer').toString();\n    }\n\n    if ($('.csa-dni').data('referrer-number')) {\n      refnum = $('.csa-dni').data('referrer-number').toString();\n    } // If there's a querystring, get the DNI code from that\n\n\n    if (typeof dnivar !== \"undefined\" && dnivar != '') {\n      dnicode = getParameterByName(dnivar);\n\n      if (dnicode !== false) {\n        createCookie('dni_tag', dnicode, 30);\n      } else {\n        // If there's no query string, get the DNI code from the cookie\n        dnicode = readCookie('dni_tag');\n\n        if (dnicode == null || dnicode == \"null\") {\n          dnicode = false;\n        }\n      }\n    } // If there's no DNI code, use the default number\n\n\n    if (dnicode === false) {\n      if (defaultnum != servernum) {\n        console.log(JSON.stringify(\"DNI does not match. Correcting.\"));\n        console.log(JSON.stringify(refnum, null, 4));\n\n        if (refnum !== '') {\n          var dni_number_formatted = format_number(refnum, numformat, charmask);\n\n          if (dni_number_formatted !== false) {\n            $('.dni-link').each(function () {\n              $(this).attr('href', 'tel:' + refnum);\n              $(this).html(dni_number_formatted);\n            });\n          }\n        } else {\n          var dni_number_formatted = format_number(defaultnum, numformat, charmask);\n\n          if (dni_number_formatted !== false) {\n            $('.dni-link').each(function () {\n              $(this).attr('href', 'tel:' + defaultnum);\n              $(this).html(dni_number_formatted);\n            });\n          }\n        }\n      } else {\n        console.log(\"Default DNI Match\");\n      }\n    } else {\n      // Verify that the DNI number displayed is correct\n      var thecode = typeof dnicode == false ? tag : dnicode;\n      var postdata = get_dni_object(\"csa_challenge_number\", \"\", phoneid, \"\", thecode, \"\", \"\", \"\");\n      $.ajax({\n        url: csa_ajaxobject.ajax_url,\n        type: 'POST',\n        dataType: 'json',\n        data: postdata,\n        error: function error(jqXHR, textStatus, errorThrown) {\n          console.log(JSON.stringify(errorThrown, null, 4));\n        },\n        success: function success(data, textStatus, jqXHR) {\n          if (data.message == \"success\") {\n            var challengenum = data.content[0];\n\n            if (challengenum != servernum) {\n              console.log(JSON.stringify(\"DNI does not match. Correcting.\"));\n              console.log(JSON.stringify(refnum, null, 4));\n              var dni_number_formatted = format_number(challengenum, numformat, charmask);\n\n              if (dni_number_formatted !== false) {\n                $('.dni-link').each(function () {\n                  $(this).attr('href', 'tel:' + challengenum);\n                  $(this).find('span').html(dni_number_formatted);\n                });\n              }\n            } else {\n              console.log(\"DNI Match\");\n            }\n          } else {\n            console.log(JSON.stringify(\"No records returned.\", null, 4));\n          }\n        }\n      });\n    }\n  }\n\n  function createCookie(name, value, days) {\n    var expires;\n\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = \"; expires=\" + date.toGMTString();\n    } else {\n      expires = \"\";\n    }\n\n    document.cookie = encodeURIComponent(name) + \"=\" + encodeURIComponent(value) + expires + \"; path=/\";\n  }\n\n  function readCookie(name) {\n    var nameEQ = encodeURIComponent(name) + \"=\";\n    var ca = document.cookie.split(';');\n\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length);\n      }\n\n      if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length));\n    }\n\n    return null;\n  }\n\n  function eraseCookie(name) {\n    createCookie(name, \"\", -1);\n  }\n\n  function getParameterByName(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n        results = regex.exec(url);\n    if (!results) return false;\n    if (!results[2]) return false;\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n  }\n\n  function format_number(rawnumber, numformat, charmask) {\n    if (rawnumber.length === (numformat.match(new RegExp(charmask, \"g\")) || []).length) {\n      var x = 0;\n      var nummask = \"\";\n      var i;\n\n      for (i = 0; i < numformat.length; i++) {\n        if (numformat[i] == charmask) {\n          nummask += rawnumber.charAt(x);\n          x++;\n        } else {\n          nummask += numformat.charAt(i);\n        }\n      }\n\n      if (nummask.indexOf(charmask) === -1) {\n        return nummask;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  function get_dni_object(action, dniid, phoneid, locid, tag, dninum, desc, status) {\n    var postdata = {\n      \"action\": action,\n      \"dni_id\": dniid,\n      \"parent_phone_id\": phoneid,\n      \"location_id\": locid,\n      \"dni_tag\": tag,\n      \"dni_number\": dninum,\n      \"dni_description\": desc,\n      \"dni_status\": status\n    };\n    return postdata;\n  }\n});\n\n},{}]},{},[1]);\n"]}